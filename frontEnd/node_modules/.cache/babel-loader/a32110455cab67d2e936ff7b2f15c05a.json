{"remainingRequest":"/Users/movi/Desktop/current/frontEnd/node_modules/babel-loader/lib/index.js!/Users/movi/Desktop/current/frontEnd/src/utils/request.js","dependencies":[{"path":"/Users/movi/Desktop/current/frontEnd/src/utils/request.js","mtime":1679890316000},{"path":"/Users/movi/Desktop/current/frontEnd/babel.config.js","mtime":1679456648000},{"path":"/Users/movi/Desktop/current/frontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1651221196058},{"path":"/Users/movi/Desktop/current/frontEnd/node_modules/babel-loader/lib/index.js","mtime":1669512949620}],"contextDependencies":[],"result":["import Vue from 'vue';\nimport axios from 'axios';\nimport store from '@/store';\nimport notification from 'ant-design-vue/es/notification';\nimport { VueAxios } from \"./axios\";\nimport { ACCESS_TOKEN } from '@/store/mutation-types';\n\n// 创建 axios 实例\nvar service = axios.create({\n  baseURL: process.env.VUE_APP_API_BASE_URL,\n  // api base_url\n  timeout: 6000 // 请求超时时间\n});\n\nvar err = function err(error) {\n  if (error.response) {\n    var data = error.response.data;\n    var token = Vue.ls.get(ACCESS_TOKEN);\n    if (error.response.status === 403) {\n      notification.error({\n        message: 'Forbidden',\n        description: data.message\n      });\n    }\n    if (error.response.status === 401 && !(data.result && data.result.isLogin)) {\n      notification.error({\n        message: 'Unauthorized',\n        description: 'Authorization verification failed'\n      });\n      if (token) {\n        store.dispatch('Logout').then(function () {\n          setTimeout(function () {\n            window.location.reload();\n          }, 1500);\n        });\n      }\n    }\n  }\n  return Promise.reject(error);\n};\n\n// request interceptor\nservice.interceptors.request.use(function (config) {\n  var token = Vue.ls.get(ACCESS_TOKEN);\n  if (token) {\n    config.headers['Access-Token'] = token; // 让每个请求携带自定义 token 请根据实际情况自行修改\n  }\n\n  return config;\n}, err);\n\n// response interceptor\nservice.interceptors.response.use(function (response) {\n  if (response.data.message === \"授权失败\") {\n    var token = Vue.ls.get(ACCESS_TOKEN);\n    if (token) {\n      store.dispatch('Logout').then(function () {\n        notification.error({\n          message: '授权失败，请重新登录！',\n          description: 'Authorization verification failed'\n        });\n        setTimeout(function () {\n          window.location.reload();\n        }, 1500);\n      });\n    }\n  }\n  return response.data;\n}, err);\nvar installer = {\n  vm: {},\n  install: function install(Vue) {\n    Vue.use(VueAxios, service);\n  }\n};\nexport { installer as VueAxios, service as axios };",{"version":3,"names":["Vue","axios","store","notification","VueAxios","ACCESS_TOKEN","service","create","baseURL","process","env","VUE_APP_API_BASE_URL","timeout","err","error","response","data","token","ls","get","status","message","description","result","isLogin","dispatch","then","setTimeout","window","location","reload","Promise","reject","interceptors","request","use","config","headers","installer","vm","install"],"sources":["/Users/movi/Desktop/current/frontEnd/src/utils/request.js"],"sourcesContent":["import Vue from 'vue'\nimport axios from 'axios'\nimport store from '@/store'\nimport notification from 'ant-design-vue/es/notification'\nimport { VueAxios } from './axios'\nimport { ACCESS_TOKEN } from '@/store/mutation-types'\n\n// 创建 axios 实例\nconst service = axios.create({\n  baseURL: process.env.VUE_APP_API_BASE_URL, // api base_url\n  timeout: 6000 // 请求超时时间\n})\n\nconst err = (error) => {\n  if (error.response) {\n    const data = error.response.data\n    const token = Vue.ls.get(ACCESS_TOKEN)\n    if (error.response.status === 403) {\n      notification.error({\n        message: 'Forbidden',\n        description: data.message\n      })\n    }\n    if (error.response.status === 401 && !(data.result && data.result.isLogin)) {\n      notification.error({\n        message: 'Unauthorized',\n        description: 'Authorization verification failed'\n      })\n      if (token) {\n        store.dispatch('Logout').then(() => {\n          setTimeout(() => {\n            window.location.reload()\n          }, 1500)\n        })\n      }\n    }\n  }\n  return Promise.reject(error)\n}\n\n// request interceptor\nservice.interceptors.request.use(config => {\n  const token = Vue.ls.get(ACCESS_TOKEN)\n  if (token) {\n    config.headers['Access-Token'] = token // 让每个请求携带自定义 token 请根据实际情况自行修改\n  }\n  return config\n}, err)\n\n// response interceptor\nservice.interceptors.response.use((response) => {\n  if(response.data.message === \"授权失败\"){\n      const token = Vue.ls.get(ACCESS_TOKEN)\n      if (token) {\n        store.dispatch('Logout').then(() => {\n          notification.error({\n            message: '授权失败，请重新登录！',\n            description: 'Authorization verification failed'\n          })\n          setTimeout(() => {\n            window.location.reload()\n          }, 1500)\n        })\n      }\n  }\n  return response.data\n}, err)\n\nconst installer = {\n  vm: {},\n  install (Vue) {\n    Vue.use(VueAxios, service)\n  }\n}\n\nexport {\n  installer as VueAxios,\n  service as axios\n}\n"],"mappings":"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"}]}