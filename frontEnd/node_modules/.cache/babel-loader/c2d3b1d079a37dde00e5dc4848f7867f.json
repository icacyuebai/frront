{"remainingRequest":"/Users/movi/Desktop/current/frontEnd/node_modules/thread-loader/dist/cjs.js!/Users/movi/Desktop/current/frontEnd/node_modules/babel-loader/lib/index.js!/Users/movi/Desktop/current/frontEnd/src/store/modules/user.js","dependencies":[{"path":"/Users/movi/Desktop/current/frontEnd/src/store/modules/user.js","mtime":1680003330000},{"path":"/Users/movi/Desktop/current/frontEnd/babel.config.js","mtime":1679456648000},{"path":"/Users/movi/Desktop/current/frontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1651221196058},{"path":"/Users/movi/Desktop/current/frontEnd/node_modules/thread-loader/dist/cjs.js","mtime":1646811141074},{"path":"/Users/movi/Desktop/current/frontEnd/node_modules/babel-loader/lib/index.js","mtime":1669512949620}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport Vue from 'vue';\nimport { login, getInfo, logout } from '@/api/login';\nimport { ACCESS_TOKEN } from '@/store/mutation-types';\nimport { welcome, totree } from '@/utils/util';\nimport store from '@/store/';\nvar user = {\n  state: {\n    token: '',\n    name: '',\n    welcome: '',\n    avatar: '',\n    info: {},\n    roleType: ''\n  },\n  mutations: {\n    SET_TOKEN: function SET_TOKEN(state, token) {\n      state.token = token;\n    },\n    SET_NAME: function SET_NAME(state, _ref) {\n      var name = _ref.name,\n        welcome = _ref.welcome;\n      state.name = name;\n      state.welcome = welcome;\n    },\n    SET_AVATAR: function SET_AVATAR(state, avatar) {\n      state.avatar = avatar;\n    },\n    SET_INFO: function SET_INFO(state, info) {\n      state.info = info;\n    },\n    SET_ROLE_TYPE: function SET_ROLE_TYPE(state, role_type) {\n      state.roleType = role_type;\n    }\n  },\n  actions: {\n    // 登录\n    Login: function Login(_ref2, userInfo) {\n      var commit = _ref2.commit,\n        dispatch = _ref2.dispatch,\n        getters = _ref2.getters;\n      return new Promise(function (resolve, reject) {\n        login(userInfo).then(function (response) {\n          if (response.success) {\n            Vue.ls.set(ACCESS_TOKEN, response.token, 7 * 24 * 60 * 60 * 1000);\n            commit('SET_TOKEN', response.token);\n            resolve(response);\n          } else {\n            reject(response);\n          }\n        }).then(function (_) {\n          // 获取用户信息\n          dispatch('GetInfo');\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 获取用户信息\n    GetInfo: function GetInfo(_ref3) {\n      var commit = _ref3.commit,\n        dispatch = _ref3.dispatch;\n      return new Promise(function (resolve, reject) {\n        getInfo().then(function (response) {\n          var result = response.result;\n          commit('SET_ROLE_TYPE', result.role_type);\n          commit('SET_INFO', result);\n          commit('SET_NAME', {\n            name: result.name,\n            welcome: welcome()\n          });\n          commit('SET_AVATAR', result.avatar);\n          store.dispatch('set_router');\n          resolve(response);\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 登出\n    Logout: function Logout(_ref4) {\n      var commit = _ref4.commit,\n        state = _ref4.state;\n      return new Promise(function (resolve) {\n        commit('SET_TOKEN', '');\n        Vue.ls.remove(ACCESS_TOKEN);\n        commit('SET_ROLE_TYPE', '');\n        commit('SET_INFO', '');\n        commit('SET_NAME', '');\n        commit('SET_AVATAR', '');\n        logout(state.token).then(function () {\n          resolve();\n        }).catch(function () {\n          resolve();\n        });\n      });\n    }\n  }\n};\nexport default user;",null]}