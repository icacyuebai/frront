{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2d21e3a3\"],{d551:function(e,t,a){\"use strict\";a.r(t);a(\"ac6a\"),a(\"456d\"),a(\"7f7f\");var n=function(){var e=this,t=e._self._c;return t(\"div\",[t(\"a-row\",{attrs:{gutter:16}},[t(\"a-col\",{attrs:{span:10}},[t(\"a-card\",{attrs:{title:\"主题\",bordered:!1}},[t(\"p\",[e._v(e._s(e.event.name||\"\"))])])],1),t(\"a-col\",{attrs:{span:4}},[t(\"a-card\",{attrs:{title:\"类型\",bordered:!1}},[t(\"p\",[e._v(e._s(e.event.type||\"\"))])])],1),t(\"a-col\",{attrs:{span:10}},[t(\"a-card\",{attrs:{title:\"URL\",bordered:!1}},[t(\"p\",[e._v(e._s(e.event.url||\"\"))])])],1)],1),t(\"a-row\",{staticStyle:{\"margin-top\":\"16px\"},attrs:{gutter:16}},[t(\"a-col\",{attrs:{span:24}},[t(\"a-card\",{attrs:{title:\"事件简介\",bordered:!1}},[e._v(\"\\n        \"+e._s(e.event.introduction||\"\")+\"\\n      \")])],1)],1),t(\"a-row\",{staticStyle:{\"margin-top\":\"16px\"},attrs:{gutter:16}},[t(\"a-col\",{attrs:{span:24}},[t(\"a-card\",{attrs:{title:\"事件经过\",bordered:!1}},[e._v(\"\\n        \"+e._s(e.event.process||\"\")+\"\\n      \")])],1)],1),t(\"a-row\",{staticStyle:{\"margin-top\":\"16px\"},attrs:{gutter:16}},[t(\"a-col\",{attrs:{span:24}},[t(\"a-card\",{attrs:{title:\"事件抽取\",bordered:!1}},[t(\"div\",{staticClass:\"search-term\"},[t(\"a-select\",{ref:\"select\",staticStyle:{width:\"120px\",\"margin-right\":\"20px\"},attrs:{placeholder:\"事故类型\",allowClear:!0},model:{value:e.type,callback:function(t){e.type=t},expression:\"type\"}},[t(\"a-select-option\",{attrs:{value:\"中毒窒息\"}},[e._v(\"中毒窒息\")]),t(\"a-select-option\",{attrs:{value:\"压力容器\"}},[e._v(\"压力容器\")]),t(\"a-select-option\",{attrs:{value:\"坍塌事故\"}},[e._v(\"坍塌事故\")]),t(\"a-select-option\",{attrs:{value:\"机械伤害\"}},[e._v(\"机械伤害\")]),t(\"a-select-option\",{attrs:{value:\"淹溺事故\"}},[e._v(\"淹溺事故\")]),t(\"a-select-option\",{attrs:{value:\"火灾事故\"}},[e._v(\"火灾事故\")]),t(\"a-select-option\",{attrs:{value:\"灼烫事故\"}},[e._v(\"灼烫事故\")]),t(\"a-select-option\",{attrs:{value:\"爆炸事故\"}},[e._v(\"爆炸事故\")]),t(\"a-select-option\",{attrs:{value:\"物体打击\"}},[e._v(\"物体打击\")]),t(\"a-select-option\",{attrs:{value:\"矿山事故\"}},[e._v(\"矿山事故\")]),t(\"a-select-option\",{attrs:{value:\"空难事故\"}},[e._v(\"空难事故\")]),t(\"a-select-option\",{attrs:{value:\"起重事故\"}},[e._v(\"起重事故\")]),t(\"a-select-option\",{attrs:{value:\"起重伤害\"}},[e._v(\"起重伤害\")]),t(\"a-select-option\",{attrs:{value:\"车辆伤害\"}},[e._v(\"车辆伤害\")]),t(\"a-select-option\",{attrs:{value:\"锅炉事故\"}},[e._v(\"锅炉事故\")]),t(\"a-select-option\",{attrs:{value:\"高处坠落\"}},[e._v(\"高处坠落\")])],1),t(\"a-button\",{on:{click:e.getTableData}},[e._v(\"查询\")]),\"admin\"===e.roleType?t(\"a-button\",{staticClass:\"right\",on:{click:e.showUploadModal}},[e._v(\"上传\")]):e._e()],1),t(\"a-table\",{attrs:{columns:e.columns,\"data-source\":e.data,pagination:!1},scopedSlots:e._u([{key:\"name\",fn:function(a){return t(\"a\",{},[e._v(e._s(a))])}},{key:\"action\",fn:function(a,n){return t(\"span\",{},[\"1\"!==n.is_pass?[t(\"a-button\",{attrs:{type:\"link\"},on:{click:function(t){return e.pass(n.id)}}},[e._v(\"通过\")]),t(\"a-button\",{attrs:{type:\"link\"},on:{click:function(t){return e.updateEventExtraction(n)}}},[e._v(\"修正\")]),\"admin\"===e.roleType?t(\"a-button\",{attrs:{type:\"link\"},on:{click:function(t){return e.deleteEventExtr(n.id)}}},[e._v(\"删除\")]):e._e()]:[t(\"a-button\",{attrs:{type:\"link\",disabled:\"\"}},[e._v(\"已标记成功\")])]],2)}}])}),t(\"a-pagination\",{staticStyle:{\"margin-top\":\"20px\",float:\"right\"},attrs:{\"default-current\":e.page_num,total:e.total},on:{change:e.handlePageChange}})],1)],1)],1),t(\"a-row\",{staticStyle:{\"margin-top\":\"16px\"}},[t(\"a-col\",{attrs:{span:24}},[t(\"a-card\",{attrs:{title:\"图谱\",bordered:!1}},[t(\"div\",{staticStyle:{height:\"700px\",width:\"1500px\"},attrs:{id:\"echarts\"}})])],1)],1),t(\"a-modal\",{attrs:{title:\"上传事件文件\",\"confirm-loading\":e.confirmLoading},on:{ok:e.handleOk},model:{value:e.uploadModalVisible,callback:function(t){e.uploadModalVisible=t},expression:\"uploadModalVisible\"}},[t(\"a-upload\",{attrs:{name:\"file\",multiple:!1,action:\"/api/eventCount/upload\"},on:{change:e.handleChange},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:\"fileList\"}},[t(\"a-button\",[t(\"upload-outlined\"),e._v(\"\\n        上传文件\\n      \")],1)],1)],1),e.nodeForm?t(\"a-modal\",{attrs:{title:e.nodeForm.name,width:\"40%\",height:\"40%\"},scopedSlots:e._u([{key:\"footer\",fn:function(){return[t(\"a-button\",{key:\"back\",on:{click:e.closeNodeModal}},[e._v(\"取消\")]),t(\"a-button\",{key:\"submit\",attrs:{type:\"primary\",loading:e.confirmLoading},on:{click:e.submitUpdateNode}},[e._v(\"提交\")])]},proxy:!0}],null,!1,2505984011),model:{value:e.nodeModalVisible,callback:function(t){e.nodeModalVisible=t},expression:\"nodeModalVisible\"}},[t(\"a-form\",{attrs:{labelAlign:\"left\"}},[e._l(Object.keys(e.nodeForm),(function(a){return[-1===[\"name\",\"x\",\"y\"].indexOf(a)?t(\"a-form-item\",{attrs:{labelCol:{span:8},wrapperCol:{span:14},label:a}},[t(\"a-input\",{model:{value:e.nodeForm[a],callback:function(t){e.$set(e.nodeForm,a,t)},expression:\"nodeForm[key]\"}})],1):e._e()]}))],2)],1):e._e(),t(\"a-modal\",{attrs:{title:\"修改事件\",width:\"50%\"},scopedSlots:e._u([{key:\"footer\",fn:function(){return[t(\"a-button\",{key:\"back\",on:{click:e.closeModal}},[e._v(\"取消\")]),t(\"a-button\",{key:\"submit\",attrs:{type:\"primary\",loading:e.confirmLoading},on:{click:e.submitForm}},[e._v(\"提交\")])]},proxy:!0}]),model:{value:e.updateModalVisible,callback:function(t){e.updateModalVisible=t},expression:\"updateModalVisible\"}},[t(\"a-form\",{attrs:{model:e.form}},[t(\"a-form-item\",{attrs:{label:\"事故名称\"}},[t(\"a-input\",{attrs:{disabled:!0},model:{value:e.form.event_name,callback:function(t){e.$set(e.form,\"event_name\",t)},expression:\"form.event_name\"}})],1),t(\"a-form-item\",{attrs:{label:\"事件类别\"}},[t(\"a-input\",{model:{value:e.form.type,callback:function(t){e.$set(e.form,\"type\",t)},expression:\"form.type\"}})],1),t(\"a-form-item\",{attrs:{label:\"事件类型\"}},[t(\"a-input\",{model:{value:e.form.type_detail,callback:function(t){e.$set(e.form,\"type_detail\",t)},expression:\"form.type_detail\"}})],1),t(\"a-form-item\",{attrs:{label:\"时间\"}},[t(\"a-input\",{model:{value:e.form.date,callback:function(t){e.$set(e.form,\"date\",t)},expression:\"form.date\"}})],1),t(\"a-form-item\",{attrs:{label:\"地点\"}},[t(\"a-input\",{model:{value:e.form.position,callback:function(t){e.$set(e.form,\"position\",t)},expression:\"form.position\"}})],1),t(\"a-form-item\",{attrs:{label:\"机构\"}},[t(\"a-input\",{model:{value:e.form.company,callback:function(t){e.$set(e.form,\"company\",t)},expression:\"form.company\"}})],1),t(\"a-form-item\",{attrs:{label:\"伤亡人数\"}},[t(\"a-input\",{model:{value:e.form.loss_people,callback:function(t){e.$set(e.form,\"loss_people\",t)},expression:\"form.loss_people\"}})],1),t(\"a-form-item\",{attrs:{label:\"经济损失\"}},[t(\"a-input\",{model:{value:e.form.loss_economic,callback:function(t){e.$set(e.form,\"loss_economic\",t)},expression:\"form.loss_economic\"}})],1)],1)],1)],1)},o=[],r=(a(\"8e6e\"),a(\"96cf\"),a(\"3b8d\")),i=a(\"bd86\"),s=a(\"0905\"),l=a(\"b775\");function c(e){return Object(l[\"b\"])({url:\"/eventCount/list\",method:\"get\",params:e})}function u(e){return Object(l[\"b\"])({url:\"/eventCount/delete\",method:\"post\",data:e,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}function p(e){return Object(l[\"b\"])({url:\"/eventCount/pass\",method:\"post\",data:e})}function d(e){return Object(l[\"b\"])({url:\"/eventCount/update\",method:\"post\",data:e,headers:{\"Content-Type\":\"application/json;charset=UTF-8\"}})}var m=a(\"2f62\"),f=a(\"56cd\"),h=a(\"313e\");function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){Object(i[\"a\"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={name:\"EventDetail\",data:function(){return{event:{url:\"\",name:\"\",introduction:\"\",process:\"\",type:\"\"},type:null,data:null,columns:[{title:\"id\",key:\"id\",dataIndex:\"id\",width:\"100px\"},{title:\"公司\",dataIndex:\"company\",key:\"company\",width:\"100px\",ellipsis:!0},{title:\"时间\",dataIndex:\"date\",key:\"date\",ellipsis:!0},{title:\"主题\",dataIndex:\"event_name\",key:\"event_name\",ellipsis:!0},{title:\"经济损失\",dataIndex:\"loss_economic\",key:\"loss_economic\"},{title:\"伤亡人数\",dataIndex:\"loss_people\",key:\"loss_people\"},{title:\"地点\",dataIndex:\"position\",key:\"position\"},{title:\"事件类别\",dataIndex:\"type\",key:\"type\",width:\"120px\"},{title:\"事件类型\",dataIndex:\"type_detail\",key:\"type_detail\",width:\"140px\"},{title:\"操作\",key:\"action\",scopedSlots:{customRender:\"action\"},width:\"180px\"}],event_name:null,json:null,toUpdateJsonRecord:null,jsons:[],viewJsonModalVisible:!1,myChart:null,jsonData:null,nodeForm:null,nodeIndex:null,nodeModalVisible:!1,page_num:1,page_size:10,total:0,uploadModalVisible:!1,confirmLoading:!1,file:null,fileList:[],updateModalVisible:!1,form:{event_name:\"\",date:\"\",position:\"\",company:\"\",loss_people:\"\",loss_economic:\"\",type:\"\",type_detail:\"\"}}},computed:b({},Object(m[\"c\"])([\"roleType\"])),methods:{handlePageChange:function(){var e=Object(r[\"a\"])(regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c({page_num:t,page_size:a});case 2:n=e.sent,this.data=n.result.event_count,this.total=n.result.count;case 5:case\"end\":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),showUploadModal:function(){this.uploadModalVisible=!0},handleOk:function(){this.confirmLoading=!1,this.uploadModalVisible=!1,this.updateModalVisible=!1},pass:function(){var e=Object(r[\"a\"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p({id:t});case 2:a=e.sent,200===a.code&&(f[\"a\"][\"success\"]({message:\"标记成功\"}),this.getTableData());case 4:case\"end\":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),updateEventExtraction:function(e){this.updateModalVisible=!0,this.form=e},closeModal:function(){this.form={event_name:\"\",date:\"\",position:\"\",company:\"\",loss_people:\"\",loss_economic:\"\",type:\"\",type_detail:\"\"},this.updateModalVisible=!1},submitUpdateNode:function(){var e=Object(r[\"a\"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.json){e.next=2;break}return e.abrupt(\"return\");case 2:return this.json.dict_ls[this.nodeIndex]=this.nodeForm,e.next=5,Object(s[\"h\"])({id:this.toUpdateJsonRecord.id,json:JSON.stringify(this.json)});case 5:t=e.sent,200===t.code&&(f[\"a\"][\"success\"]({message:\"更新成功\"}),this.closeNodeModal());case 7:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),submitForm:function(){var e=Object(r[\"a\"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.confirmLoading=!0,e.next=3,d(this.form);case 3:t=e.sent,200===t.code&&(this.confirmLoading=!1,this.updateModalVisible=!1,this.getTableData(),f[\"a\"][\"success\"]({message:\"更新成功\"}));case 5:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getTableData:function(){var e=Object(r[\"a\"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c({page_num:1,page_size:10,type:this.type,event_name:this.event_name});case 2:t=e.sent,this.data=t.result.event_count,this.total=t.result.count,this.page_num=t.result.page_num,this.page_size=t.result.page_size;case 7:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleChange:function(e){\"uploading\"!==e.file.status&&console.log(e.file,e.fileList),\"done\"===e.file.status?(f[\"a\"][\"success\"]({message:\"上传成功\"}),this.getTableData()):\"error\"===e.file.status&&f[\"a\"][\"error\"]({message:\"上传失败\"})},handleEventChange:function(){var e=Object(r[\"a\"])(regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c({page_num:t,page_size:a});case 2:n=e.sent,this.data=n.result.event_count,this.total=n.result.count;case 5:case\"end\":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),deleteEventExtr:function(e){var t=this;this.$confirm({title:\"Are you sure delete this task?\",content:\"Some descriptions\",okText:\"Yes\",okType:\"danger\",cancelText:\"No\",onOk:function(){var a=Object(r[\"a\"])(regeneratorRuntime.mark((function a(){var n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,u({id:e});case 2:if(n=a.sent,200!==n.code){a.next=12;break}return t.$notification.open({message:\"删除成功\",duration:1}),a.next=7,c({page_num:1,page_size:10});case 7:o=a.sent,t.data=o.result.users,t.total=o.result.count,t.page_num=o.result.page_num,t.page_size=o.result.page_size;case 12:case\"end\":return a.stop()}}),a)})));function n(){return a.apply(this,arguments)}return n}(),onCancel:function(){console.log(\"Cancel\")}})},closeNodeModal:function(){this.nodeModalVisible=!1,this.nodeForm=null,this.nodeIndex=null},initEchart:function(){if(!this.myChart){var e=document.getElementById(\"echarts\");this.myChart=h[\"a\"](e)}var t;t={tooltip:{formatter:function(e){var t=e.data,a='<div style=\"width:280px;height:180px;background:#5370c6;border:1px solid rgba(7,166,255,0.7)\"><div style=\"width:100%;min-height:22px;line-height:22px;border-bottom:2px solid rgba(7,166,255,0.7);padding:0 20px\"><span style=\"color:#fff;font-size:14px;word-wrap:break-word;white-space:normal;\">'+e.name+'</span></div><div style=\"padding:20px\">';for(var n in t)-1===[\"name\",\"x\",\"y\"].indexOf(n)&&(a+='<p style=\"color:#fff;font-size:12px;\">\\n                        '.concat(n,\": \").concat(t[n],\"</span>\\n                       </p>\"));return a+=\"</div></div>\",a}},animationDurationUpdate:1500,animationEasingUpdate:\"quinticInOut\",series:[{type:\"graph\",layout:\"none\",symbolSize:50,roam:!0,label:{formatter:\"{b}\",show:!0},edgeSymbol:[\"circle\",\"arrow\"],edgeSymbolSize:[4,10],edgeLabel:{fontSize:20},data:this.json.dict_ls,links:this.json.links,lineStyle:{opacity:.9,width:2,curveness:0}}]},t&&this.myChart.setOption(t);var a=this;this.myChart.on(\"click\",(function(e){var t=e.data;e.data&&Object.keys(t).length>3&&(a.nodeModalVisible=!0,a.nodeForm=t,a.nodeIndex=e.dataIndex)}))}},created:function(){var e=Object(r[\"a\"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$route.query||!this.$route.query.name){e.next=8;break}return this.event_name=this.$route.query.name,e.next=4,Object(s[\"e\"])({name:this.event_name});case 4:return t=e.sent,200===t.code&&(this.event=t.result.event,this.event.json&&(this.json=JSON.parse(this.event.json),this.toUpdateJsonRecord=this.event,a=this,this.$nextTick((function(){a.initEchart()})))),e.next=8,this.getTableData();case 8:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},g=y,_=a(\"2877\"),x=Object(_[\"a\"])(g,n,o,!1,null,\"6623a33c\",null);t[\"default\"]=x.exports}}]);","extractedComments":[]}